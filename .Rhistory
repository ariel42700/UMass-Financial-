install.packages("tree")
install.packages("rpart")
library(rpart)
library(tree)
seed.val<- 12345
baseball <- read.csv("C:/Users/alain/OneDrive/Documents/Info 248/baseball.csv")
baseball <- na.omit(baseball)
baseball <- read.csv("C:/Users/alain/OneDrive/Documents/Info 248/baseball.csv")
bb.df <- na.omit(baseball)
fit1 <- rpart(Salary ~ .,	method="anova", data=bb.df)
plot(fit1, uniform=TRUE,
main="Regression Tree predicting Salary ")
text(fit1, use.n=TRUE, all=TRUE, cex=.8)
fit1
printcp(fit1) # display the results
summary(fit1) # detailed summary of splits
plotcp(fit1)
best.cp <- fit1$cptable[5]
fit2 <- prune(fit1, cp = best.cp)
plot(fit2, uniform=TRUE,
main="Regression Tree predicting Salary ")
text(fit2, use.n=TRUE, all=TRUE, cex=.8)
RNGversion("3.4.3")
set.seed(seed.val)
train.rows<-sample(1:nrow(bb.df), 200)
train.data<-bb.df[train.rows,]
test.data<-bb.df[-train.rows,]
true.vals<-bb.df$Salary[-train.rows]
RNGversion("3.4.3")
set.seed(seed.val)
train.rows<-sample(1:nrow(bb.df), 200)
train.data<-bb.df[train.rows,]
test.data<-bb.df[-train.rows,]
true.vals<-bb.df$Salary[-train.rows]
tree1 <- rpart(Salary ~.,data = train.data, method = "anova")
plotcp(tree1)
tree1$cptable
best.cp <- tree1$cptable[4]
tree2<-  prune(tree1, cp = best.cp)
tree1.pred<- predict(tree1, test.data, type="vector")
tree2.pred<- predict(tree2, test.data, type="vector")
rmse1<- sqrt(mean((tree1.pred-true.vals) ^2))
mae1<- mean(abs(tree1.pred-true.vals))
rmse2<- sqrt(mean((tree2.pred-true.vals) ^2))
mae2<- mean(abs(tree2.pred-true.vals))
res<-c(rmse1, rmse2, mae1, mae2)
dim(res) <- c(2,2)
colnames(res) <- c("rmse","mae")
colors <- c("grey45", "grey70")
barplot(res, main="Prediction Errors", ylab = "Error", ylim=c(0, 400), cex.lab = 1.5, cex.main = 1.4, beside=TRUE, col=colors)
legend("topright", legend=c("Tree 1", "Tree 2"),
fill=colors, cex=0.8)
sales.df <- read.csv("C:/Users/alain/OneDrive/Documents/Info 248/carseat_sales.csv")
sales.tree1<- tree(Sales ~., sales.df)
summary(sales.tree1)
plot(sales.tree1)
text(sales.tree1)
sales.tree1
RNGversion("3.4.3")
set.seed(seed.val)
train.rows<-sample(1:nrow(sales.df), 200)
test.data<-sales.df[-train.rows,]
true.labels<-sales.df$Sales[-train.rows]
sales.tree2<- tree(Sales ~., sales.df, subset=train.rows)
tree2.pred<- predict(sales.tree2, test.data, type="class")
install.packages("caret")
library(caret)
confusionMatrix(tree2.pred, true.labels)
install.packages(e1071)
install.packages("e1071")
library(e1071)
confusionMatrix(tree2.pred, true.labels)
confusionMatrix(tree2.pred, true.labels)
mean(tree1.pred != true.labels)
confusionMatrix(tree2.pred, true.labels)
mean(tree2.pred != true.labels)
confusionMatrix(tree2.pred, true.labels)
RNGversion("3.4.3")
set.seed(seed.val)
cv.tree1<-cv.tree(sales.tree2, FUN=prune.misclass)
RNGversion("3.4.3")
set.seed(seed.val)
cv.tree1<-cv.tree(sales.tree2, FUN=prune.misclass)
names(cv.tree1)
plot(cv.tree1$size, cv.tree1$dev, type="b")
cv.tree1
best.mat <- cbind(cv.tree1$size, cv.tree1$dev)
best.size <- subset(best.mat, best.mat[,2]==min(best.mat[,2]))[,1]
pruned.tree1<-prune.misclass(sales.tree2, best=best.size)
plot(pruned.tree1)
text(pruned.tree1)
prune.tree1.pred<- predict(pruned.tree1, test.data, type="class")
table(prune.tree1.pred, true.labels)
prune.tree1.pred<- predict(pruned.tree1, test.data, type="class")
table(prune.tree1.pred, true.labels)
confusionMatrix(prune.tree1.pred, true.labels)
prune.tree1.pred<- predict(pruned.tree1, test.data, type="class")
table(prune.tree1.pred, true.labels)
sales.tree2
load("C:/Users/alain/Downloads/RE2e_Exercise Data_CH12/RE2e_R Data sets_CH12/Ch12_Exercise2_Global_warming.RData")
lin.prob.scaled <- lm(humancause ~ male + white + scale(educ) + scale(incomecat) + scale(age) + scale(party7), data = dta)
summary(lin.prob.scaled)
lin.prob.scaled <- lm(humancause ~ scale(male) + scale(white) + scale(educ) + scale(incomecat) + scale(age) + scale(party7), data = dta)
summary(lin.prob.scaled)
lin.prob.scaled2 <- lm(humancause ~scale(male) + scale(white) + scale(educ) + scale(incomecat) + scale(age)  + scale(agesq) + scale(party7), data = dta)
summary(lin.prob.scaled2)
lin.prob.scaled2 <- lm(humancause ~male + scale(white) + scale(educ) + scale(incomecat) + scale(age)  + scale(agesq) + scale(party7), data = dta)
summary(lin.prob.scaled2)
mean(dta$age)
sd(dta$age)
load("fish.Rdata")
library(tree)
library(randomForest)
library(tree)
library(randomForest)
install.packages("randomForest")
library(tree)
library(randomForest)
seed.val<-1234567
carseats <- read.csv("C:/Users/alain/OneDrive/Documents/Info 248/carseat_sales.csv")
View(carseats)
View(carseats)
carseats <- read.csv("C:/Users/alain/OneDrive/Documents/Info 248/carseat_sales.csv")
carseats$Sales <- NULL
RNGversion("3.4.3")
set.seed(seed.val)
cs.df<- cs.df[,-12]
cs.df <- read.csv("C:/Users/alain/OneDrive/Documents/Info 248/carseat_sales.csv")
cs.df$Sales <- NULL
RNGversion("3.4.3")
set.seed(seed.val)
cs.df<- cs.df[,-12]
data.size<-nrow(cs.df)
train.rows<-sample(1:data.size, data.size/2)
train.data<-cs.df[train.rows,]
test.data<-cs.df[-train.rows,]
true.vals<-test.data[,1]
cs.tree <- tree(Sales ~., data = train.data)
cs.df <- read.csv("C:/Users/alain/OneDrive/Documents/Info 248/carseat_sales.csv")
#cs.df$Sales <- NULL
View(cs.df)
cs.df <- read.csv("C:/Users/alain/Downloads/carseat_sales_reg.csv")
cs.df$SalesLevel <- NULL
RNGversion("3.4.3")
set.seed(seed.val)
cs.df<- cs.df[,-12]
data.size<-nrow(cs.df)
train.rows<-sample(1:data.size, data.size/2)
train.data<-cs.df[train.rows,]
test.data<-cs.df[-train.rows,]
true.vals<-test.data[,1]
cs.tree <- tree(Sales ~., data = train.data)
summary(cs.tree)
View(cs.tree)
View(cs.tree)
View(cs.df)
View(cs.df)
cs.tree
RNGversion("3.4.3")
set.seed(seed.val)
cs.tree.cv <- cv.tree(cs.tree, FUN = prune.misclass)
RNGversion("3.4.3")
set.seed(seed.val)
cs.tree.cv <- cv.tree(cs.tree, FUN = prune)
plot(cs.tree.cv$size, cs.tree.cv$dev, type = "b")
cs.tree.cv
best.sz <- cs.tree.cv$size[11]
pruned.tree <- pruned.tree(cs.tree, best = best.sz)
best.sz <- cs.tree.cv$size[11]
pruned.tree <- prune.tree(cs.tree, best = best.sz)
best.sz <- cs.tree.cv$size[11]
pruned.tree <- prune.tree(cs.tree, best = best.sz)
summary(pruned.tree)
View(cs.tree)
View(cs.tree.cv)
View(cs.df)
unprunde.pred <- predict(pruned.tree, test.data)
unprune.pred <- predict(cs.tree, test.data)
unprune.mse<- sqrt(mean((unprune.pred-true.vals) ^2))
unprune.mse
prune.pred <- predict(pruned.tree, test.data)
prune.mse<- sqrt(mean((prune.pred-true.vals) ^2))
prune.mse
unprune.pred <- predict(cs.tree, test.data)
unprune.mse<- (mean((unprune.pred-true.vals) ^2))
unprune.mse
prune.pred <- predict(pruned.tree, test.data)
prune.mse<- (mean((prune.pred-true.vals) ^2))
prune.mse
RNGversion("3.4.3")
set.seed(seed.val)
rf.fit <- randomForest(Sales ~.,data = train.data, mtry  = 6, importance = T)
summary(rf.fit)
View(rf.fit)
View(rf.fit)
rf.pred <- predict(rf.fit, test.data)
rf.mse <- mean((rf.pred - true.vals)^2)
rf.mse
varImpPlot(rf.fit)
summary(pruned.tree)
library(xlsx)
library(xlsx)
library(xlsxjars)
detach("package:xlsxjars", unload = TRUE)
library(xlsx)
library(xlsx)
library(xlsxjars)
library(xlsx)
library(rJava)
library(rJava)
library(rJava)
library(rJava)
Sys.setenv(JAVA_HOME = "C:/Program Files (x86)/Java/jre1.8.0_241")
library(rJava)
Sys.setenv(JAVA_HOME = "C:/Program Files (x86)/Java/jre1.8.0_241")
library(rJava)
Sys.setenv(JAVA_HOME = "C:/Program Files (x86)/Java/jre1.8.0_241")
library(rJava)
Sys.setenv(JAVA_HOME = "C:/Program Files (x86)/Java/jre1.8.0_241")
library(rJava)
Sys.setenv(JAVA_HOME = "C:/Program Files (x86)/Java/jre1.8.0_241")
library(rJava)
install.packages("tidyselect")
Sys.setenv(JAVA_HOME = "C:/Program Files (x86)/Java/jre1.8.0_241")
library(rJava)
install.packages("tidyselect")
Sys.setenv(JAVA_HOME = "C:/Program Files (x86)/Java/jre1.8.0_241")
library(rJava)
install.packages("tidyselect")
#install.packages("tidyselect")
Sys.setenv(JAVA_HOME = "C:/Program Files (x86)/Java/jre1.8.0_241")
library(rJava)
data <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 1)
data <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 1)
data <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 1)
data <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 1)
data <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 1)
library(readxl)
library(readxl)
data <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 1)
View(data)
View(data)
library(readxl)
CashFlows <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 1)
library(readxl)
CashFlows <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 1)
CashFlows <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 2)
View(CashFlows)
View(CashFlows)
library(readxl)
CashFlows <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 1)
RevenuesExpenses <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 2)
NetPosition <- read_excel("C:/Users/alain/Downloads/UMass Balance sheets.xlsx", sheet = 3)
setwd("~/Info 248/Project")
library(readxl)
CashFlows <- read_excel("UMass Balance sheets.xlsx", sheet = 1)
RevenuesExpenses <- read_excel("UMass Balance sheets.xlsx", sheet = 2)
NetPosition <- read_excel("UMass Balance sheets.xlsx", sheet = 3)
View(NetPosition)
View(NetPosition)
library(readxl)
CashFlows <- read_excel("UMass Balance sheets.xlsx", sheet = 1)
RevenuesExpenses <- read_excel("UMass Balance sheets.xlsx", sheet = 2)
NetPosition <- read_excel("UMass Balance sheets.xlsx", sheet = 3)
netPosNet <- subset(NetPosition, NET = "1")
netPosNet<- netPosNet[,2:6]
netPosNet
NetPosition <- as.numeric(as.vector(NetPosition))
View(netPosNet)
library(readxl)
CashFlows <- read_excel("UMass Balance sheets.xlsx", sheet = 1)
RevenuesExpenses <- read_excel("UMass Balance sheets.xlsx", sheet = 2)
NetPosition <- read_excel("UMass Balance sheets.xlsx", sheet = 3)
netPosNet <- subset(NetPosition, NETS = "1")
netPosNet<- netPosNet[,2:6]
netPosNet
NetPosition <- as.numeric(as.vector(NetPosition))
library(readxl)
CashFlows <- read_excel("UMass Balance sheets.xlsx", sheet = 1)
RevenuesExpenses <- read_excel("UMass Balance sheets.xlsx", sheet = 2)
NetPosition <- read_excel("UMass Balance sheets.xlsx", sheet = 3)
netPosNet <- subset(NetPosition, NETS == "1")
netPosNet<- netPosNet[,2:6]
netPosNet
NetPosition <- as.numeric(as.vector(NetPosition))
library(readxl)
CashFlows <- read_excel("UMass Balance sheets.xlsx", sheet = 1)
RevenuesExpenses <- read_excel("UMass Balance sheets.xlsx", sheet = 2)
NetPosition <- read_excel("UMass Balance sheets.xlsx", sheet = 3)
netPosNet <- subset(NetPosition, NETS == "1")
netPosNet<- netPosNet[,2:6]
netPosNet
netPosNet <- as.numeric(as.vector(netPosNet))
library(readxl)
CashFlows <- read_excel("UMass Balance sheets.xlsx", sheet = 1)
RevenuesExpenses <- read_excel("UMass Balance sheets.xlsx", sheet = 2)
NetPosition <- read_excel("UMass Balance sheets.xlsx", sheet = 3)
netPosNet <- subset(NetPosition, NETS == "1")
netPosNet<- netPosNet[1,2:6]
netPosNet
netPosNet <- as.numeric(as.vector(netPosNet))
netPosNet <- rev(netPosNet)
NetPosition.ts <-netPosNet, frequency = 1, start = c(2015,1))
library(readxl)
CashFlows <- read_excel("UMass Balance sheets.xlsx", sheet = 1)
RevenuesExpenses <- read_excel("UMass Balance sheets.xlsx", sheet = 2)
NetPosition <- read_excel("UMass Balance sheets.xlsx", sheet = 3)
netPosNet <- subset(NetPosition, NETS == "1")
netPosNet<- netPosNet[1,2:6]
netPosNet
netPosNet <- as.numeric(as.vector(netPosNet))
netPosNet <- rev(netPosNet)
NetPosition.ts <-ts(netPosNet, frequency = 1, start = c(2015,1))
ts.plot(NetPosition.ts)
NetPosition.ts
